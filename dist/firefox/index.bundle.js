(()=>{"use strict";var e={342:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ClassicColumnElement=void 0;const o=n(622),s=n(593);class r extends o.ColumnElement{constructor(e){super(e),this.cachedResetText=this.columnCounter.textContent}get id(){return this.element.id}get cards(){return this.element.getElementsByClassName("project-card")}get columnCounter(){return this.element.getElementsByClassName("js-column-card-count")[0]}get resetText(){return this.cachedResetText}extractValue(e,t){let n=0,o=0;for(const r of e)if(r.dataset.cardType.includes("issue")&&!r.classList.contains("d-none")){const e=r.getElementsByClassName("IssueLabel"),c=(0,s.extractValueFromElements)(e,t);"number"==typeof c?n+=c:o++}return[n,o]}}t.ClassicColumnElement=r},622:function(e,t){var n,o,s=this&&this.__classPrivateFieldGet||function(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnElement=void 0,t.ColumnElement=class{constructor(e){n.add(this),this.calculateValue=e=>{s(this,n,"m",o).call(this);try{[this.value,this.missingValue]=this.extractValue(this.cards,e)}catch(e){}},this.value=0,this.missingValue=0,this.element=e}rewriteCounter(e){this.columnCounter.textContent=`${e}: ${this.value.toFixed(1)} | Issues without ${e} label: ${this.missingValue}`}resetCounter(){this.columnCounter.textContent=this.resetText}},n=new WeakSet,o=function(){this.value=0,this.missingValue=0}},889:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NewProjectColumnElement=void 0;const o=n(622),s=n(593);class r extends o.ColumnElement{constructor(e){super(e),this.cachedResetText=this.columnCounter.textContent}get id(){return this.element.id}get cards(){return this.element.getElementsByClassName("card__CardBase-sc-0-0")}get columnCounter(){return this.element.querySelector("[data-test-id~='column-items-counter']")}get resetText(){return this.cachedResetText}setLabels(e){this.labels=e}extractValue(e,t){let n=0,o=0;for(const e of this.labels){const r=(0,s.extractValueFromStrings)(e,t);"number"==typeof r?n+=r:o++}return[n,o]}}t.NewProjectColumnElement=r},211:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,l)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NewProjectBoard=t.ClassicProjectBoard=t.ProjectBoard=void 0;const s=n(342),r=n(889),c=n(593);class l{constructor(){this.columns=this.collectColumns(),this.url=window.location.href}static isClassic(){const e=document.getElementsByTagName("turbo-frame");return Boolean(e.length)}}t.ProjectBoard=l,t.ClassicProjectBoard=class extends l{get targetNode(){return document.getElementsByClassName("project-columns")[0]}collectColumns(){const e=document.getElementsByClassName("project-column");let t=[];for(const n of e)n instanceof HTMLElement&&t.push(new s.ClassicColumnElement(n));return t}calculateColumns(e){const t=(0,c.composeRegex)(e);for(const n of this.columns)n.calculateValue(t),n.rewriteCounter(e)}},t.NewProjectBoard=class extends l{get targetNode(){return document.querySelector("[data-test-id~='app-root']")}apidata(){return o(this,void 0,void 0,(function*(){const e=document.getElementById("memex-refresh-api-data").textContent,t=JSON.parse(e).url,n=yield fetch(`https://github.com/${t}?visibleFields=%5B%22Labels%22%5D`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),o=yield n.json();return[o.memexProjectItems,o.memexViews]}))}getGroupById(e){const t={};for(const n of e)if("board_layout"==n.layout){const e=n.verticalGroupBy;t[n.number]=e.length>0?e[0]:"Status"}return t}getLabelsData(e,t){let n;const o=[];for(const s of e)if(s.memexProjectColumnId==t&&(n=s.value.id),"Labels"==s.memexProjectColumnId)for(const e of s.value)o.push(e.name);return[n,o]}columnToLabels(e,t,n){var o;const s={},r=this.getGroupById(t)[n];for(const t of e){const e=t.memexProjectColumnValues,[n,c]=this.getLabelsData(e,r);null!==(o=s[n])&&void 0!==o||(s[n]=[]),s[n].push(c)}return s}collectColumns(){const e=document.getElementsByClassName("column-frame__StyledFrame-sc-0-0");let t=[];for(const n of e)n instanceof HTMLElement&&t.push(new r.NewProjectColumnElement(n));return t}calculateColumns(e){this.columns=this.collectColumns();const t=(0,c.composeRegex)(e),n=parseInt(window.location.href.slice(-1));this.apidata().then((o=>{const[s,r]=o,c=this.columnToLabels(s,r,n);for(const n of this.columns)n.setLabels(c[n.id]),n.calculateValue(t),n.rewriteCounter(e)}))}}},593:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.onKey=t.extractValueFromStrings=t.extractValueFromElements=t.debounce=t.composeRegex=t.combineClasses=void 0,t.combineClasses=function(...e){return e.filter((e=>"string"==typeof e)).join(" ")},t.debounce=function(e,t=500){let n;return()=>{clearTimeout(n),n=setTimeout((()=>{e()}),t)}},t.onKey=function(e,...t){return n=>{t.includes(n.key)&&(n.preventDefault(),e(n))}},t.extractValueFromElements=function(e,t){for(const n of e){const e=n.textContent.match(t);if(e)return parseFloat(e[1])}return null},t.extractValueFromStrings=function(e,t){for(const n of e){const e=n.match(t);if(e)return parseFloat(e[1])}return null},t.composeRegex=function(e){return new RegExp(`.*${e}:?.*?(\\d+\\.?[\\d]*).*`)}}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}(()=>{const e=n(211),t=n(593);let o;const s=e.ProjectBoard.isClassic()?new e.ClassicProjectBoard:new e.NewProjectBoard;function r(e,t){s.calculateColumns(e),t()}browser.runtime.onMessage.addListener((e=>{o&&o.disconnect(),"updateSelected"==e.task?(r(e.filter,(()=>{})),function(e,n){const c=s.targetNode,l={childList:!0,subtree:!0},a=(0,t.debounce)((()=>r(e,(()=>{o.disconnect(),o.observe(c,l)}))),500);o=new MutationObserver(a),o.observe(document,l)}(e.filter)):"reset"==e.task?function(){for(const e of s.columns)e.resetCounter()}():"getLocalData"==e.task&&browser.runtime.sendMessage({data:JSON.stringify([{text:"size"},{text:"points"},{text:"points"},{text:"points"}])})}))})()})();